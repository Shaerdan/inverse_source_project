{
  "_schema": "inverse_source_test_config_v1",
  "_description": "Master configuration file for inverse source localization testing",
  "_usage": "python cli.py compare --domains disk --config test_configurations.json --preset easy_validation",
  
  "active_preset": "default",
  
  "presets": {
    
    "default": {
      "description": "Default configuration - matches current CLI behavior exactly",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "domain_default",
          "depth_range": null,
          "angular_range": null
        },
        "intensities": {
          "method": "domain_default"
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": true,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B", "differential_evolution"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 5,
          "maxiter": 2000,
          "ftol": 2.220446049250313e-09,
          "gtol": 1e-05
        },
        "differential_evolution": {
          "maxiter": 200,
          "tol": 1e-06,
          "atol": 0,
          "mutation": [0.5, 1.0],
          "recombination": 0.7,
          "polish": true,
          "strategy": "best1bin",
          "seed": 42
        }
      },
      "seed": 42
    },
    
    "easy_validation": {
      "description": "Easy 4-source case for validating solver correctness - should achieve RMSE < 1e-5",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.25],
          "angular_range": [0, 360],
          "angular_jitter": 0.0
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.0,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B", "differential_evolution"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 5,
          "maxiter": 2000,
          "ftol": 1e-12,
          "gtol": 1e-10
        },
        "differential_evolution": {
          "maxiter": 300,
          "tol": 1e-08,
          "atol": 1e-10,
          "mutation": [0.5, 1.0],
          "recombination": 0.7,
          "polish": true,
          "strategy": "best1bin",
          "seed": 42
        }
      },
      "seed": 42
    },
    
    "easy_with_noise": {
      "description": "Easy 4-source case with realistic noise - should achieve RMSE < 0.01",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.25],
          "angular_range": [0, 360],
          "angular_jitter": 0.05
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 10,
          "maxiter": 2000,
          "ftol": 1e-10,
          "gtol": 1e-08
        }
      },
      "seed": 42
    },
    
    "two_sources": {
      "description": "Simplest case - 2 sources, should always converge perfectly",
      "sources": {
        "n_sources": 2,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.20, 0.30],
          "angular_range": [0, 360],
          "angular_jitter": 0.0
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.0,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 3,
          "maxiter": 1000,
          "ftol": 1e-12,
          "gtol": 1e-10
        }
      },
      "seed": 42
    },
    
    "six_sources": {
      "description": "6 sources - moderately challenging",
      "sources": {
        "n_sources": 6,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.30],
          "angular_range": [0, 360],
          "angular_jitter": 0.1
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B", "differential_evolution"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 15,
          "maxiter": 3000,
          "ftol": 1e-10,
          "gtol": 1e-08
        },
        "differential_evolution": {
          "maxiter": 500,
          "tol": 1e-07,
          "atol": 1e-09,
          "mutation": [0.5, 1.0],
          "recombination": 0.7,
          "polish": true,
          "strategy": "best1bin",
          "seed": 42
        }
      },
      "seed": 42
    },
    
    "eight_sources": {
      "description": "8 sources - challenging case",
      "sources": {
        "n_sources": 8,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.30],
          "angular_range": [0, 360],
          "angular_jitter": 0.1
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B", "differential_evolution"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 20,
          "maxiter": 5000,
          "ftol": 1e-10,
          "gtol": 1e-08
        },
        "differential_evolution": {
          "maxiter": 800,
          "tol": 1e-07,
          "atol": 1e-09,
          "mutation": [0.4, 1.0],
          "recombination": 0.8,
          "polish": true,
          "strategy": "best1bin",
          "seed": 42
        }
      },
      "seed": 42
    },
    
    "deep_sources": {
      "description": "Sources deep in domain interior (r=0.4-0.5) - known to be harder",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.50, 0.60],
          "angular_range": [0, 360],
          "angular_jitter": 0.1
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B", "differential_evolution"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 20,
          "maxiter": 5000,
          "ftol": 1e-12,
          "gtol": 1e-10
        },
        "differential_evolution": {
          "maxiter": 500,
          "tol": 1e-08,
          "atol": 1e-10,
          "mutation": [0.5, 1.0],
          "recombination": 0.7,
          "polish": true,
          "strategy": "best1bin",
          "seed": 42
        }
      },
      "seed": 42
    },
    
    "clustered_quadrant": {
      "description": "4 sources clustered in first quadrant - tests disambiguation",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.20, 0.30],
          "angular_range": [10, 80],
          "angular_jitter": 0.05
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B", "differential_evolution"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 15,
          "maxiter": 3000,
          "ftol": 1e-10,
          "gtol": 1e-08
        },
        "differential_evolution": {
          "maxiter": 400,
          "tol": 1e-07,
          "atol": 1e-09,
          "mutation": [0.5, 1.0],
          "recombination": 0.7,
          "polish": true,
          "strategy": "best1bin",
          "seed": 42
        }
      },
      "seed": 42
    },
    
    "random_intensities": {
      "description": "4 sources with random intensities (sum to zero)",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.30],
          "angular_range": [0, 360],
          "angular_jitter": 0.1
        },
        "intensities": {
          "method": "random",
          "magnitude_range": [0.5, 2.0]
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 10,
          "maxiter": 2000,
          "ftol": 1e-10,
          "gtol": 1e-08
        }
      },
      "seed": 42
    },
    
    "explicit_sources_disk": {
      "description": "Manually specified sources for reproducible testing",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "explicit"
        },
        "intensities": {
          "method": "explicit"
        },
        "explicit": [
          {"position": [0.75, 0.0], "intensity": 1.0},
          {"position": [0.0, 0.75], "intensity": -1.0},
          {"position": [-0.75, 0.0], "intensity": 1.0},
          {"position": [0.0, -0.75], "intensity": -1.0}
        ]
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.0,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 5,
          "maxiter": 2000,
          "ftol": 1e-12,
          "gtol": 1e-10
        }
      },
      "seed": 42
    },
    
    "high_noise": {
      "description": "High noise scenario (SNR ~ 20dB)",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.25],
          "angular_range": [0, 360],
          "angular_jitter": 0.0
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.01,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 15,
          "maxiter": 2000,
          "ftol": 1e-08,
          "gtol": 1e-06
        }
      },
      "seed": 42
    },
    
    "many_sensors": {
      "description": "High sensor density (200 sensors)",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.25],
          "angular_range": [0, 360],
          "angular_jitter": 0.0
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 200,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 5,
          "maxiter": 2000,
          "ftol": 1e-12,
          "gtol": 1e-10
        }
      },
      "seed": 42
    },
    
    "few_sensors": {
      "description": "Sparse sensor array (32 sensors) - tests robustness",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.25],
          "angular_range": [0, 360],
          "angular_jitter": 0.0
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 32,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 10,
          "maxiter": 2000,
          "ftol": 1e-10,
          "gtol": 1e-08
        }
      },
      "seed": 42
    },
    
    "linear_solvers_only": {
      "description": "Test linear solvers (for documentation of their limitations)",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.25],
          "angular_range": [0, 360],
          "angular_jitter": 0.0
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.001,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": true,
        "run_nonlinear": false,
        "linear_methods": ["l1", "l2", "tv_admm"],
        "alpha": 0.0001,
        "use_lcurve": false
      },
      "seed": 42
    },
    
    "de_only": {
      "description": "Differential evolution only (global optimizer)",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.25],
          "angular_range": [0, 360],
          "angular_jitter": 0.0
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.0,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["differential_evolution"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "differential_evolution": {
          "maxiter": 500,
          "tol": 1e-10,
          "atol": 1e-12,
          "mutation": [0.5, 1.0],
          "recombination": 0.7,
          "polish": true,
          "strategy": "best1bin",
          "seed": 42
        }
      },
      "seed": 42
    },
    
    "lbfgsb_only": {
      "description": "L-BFGS-B only (local optimizer with restarts)",
      "sources": {
        "n_sources": 4,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.15, 0.25],
          "angular_range": [0, 360],
          "angular_jitter": 0.0
        },
        "intensities": {
          "method": "alternating",
          "magnitude": 1.0
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.0,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["L-BFGS-B"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "L-BFGS-B": {
          "n_restarts": 10,
          "maxiter": 3000,
          "ftol": 1e-14,
          "gtol": 1e-12
        }
      },
      "seed": 42
    },
    
    "stress_test": {
      "description": "Stress test - 10 sources, noisy, deep placement",
      "sources": {
        "n_sources": 10,
        "placement": {
          "method": "angular_spread",
          "depth_range": [0.30, 0.50],
          "angular_range": [0, 360],
          "angular_jitter": 0.15
        },
        "intensities": {
          "method": "random",
          "magnitude_range": [0.5, 2.0]
        },
        "explicit": null
      },
      "measurement": {
        "n_sensors": 100,
        "noise_level": 0.005,
        "noise_type": "gaussian"
      },
      "solvers": {
        "run_linear": false,
        "run_nonlinear": true,
        "nonlinear_methods": ["differential_evolution"],
        "prefer_fem_for_polygon": true
      },
      "optimizer": {
        "differential_evolution": {
          "maxiter": 1000,
          "tol": 1e-06,
          "atol": 1e-08,
          "mutation": [0.4, 1.0],
          "recombination": 0.8,
          "polish": true,
          "strategy": "best1bin",
          "seed": 42
        }
      },
      "seed": 42
    }
  },
  
  "domain_defaults": {
    "_description": "Domain-specific default source configurations (used when placement.method='domain_default')",
    
    "disk": {
      "sources": [
        {"position": [0.75, 0.0], "intensity": 1.0},
        {"position": [0.0, 0.75], "intensity": -1.0},
        {"position": [-0.75, 0.0], "intensity": 1.0},
        {"position": [0.0, -0.75], "intensity": -1.0}
      ],
      "characteristic_size": 1.0,
      "recommended_depth_range": [0.15, 0.35]
    },
    
    "ellipse": {
      "sources": [
        {"position": [1.5, 0.0], "intensity": 1.0},
        {"position": [0.0, 0.75], "intensity": -1.0},
        {"position": [-1.5, 0.0], "intensity": 1.0},
        {"position": [0.0, -0.75], "intensity": -1.0}
      ],
      "params": {"a": 2.0, "b": 1.0},
      "characteristic_size": 1.5,
      "recommended_depth_range": [0.15, 0.35]
    },
    
    "star": {
      "sources": [
        {"position": [0.5, 0.0], "intensity": 1.0},
        {"position": [0.0, 0.5], "intensity": -1.0},
        {"position": [-0.5, 0.0], "intensity": 1.0},
        {"position": [0.0, -0.5], "intensity": -1.0}
      ],
      "params": {"n_petals": 5, "amplitude": 0.3},
      "characteristic_size": 0.7,
      "recommended_depth_range": [0.10, 0.25]
    },
    
    "square": {
      "sources": [
        {"position": [0.75, 0.75], "intensity": 1.0},
        {"position": [-0.75, 0.75], "intensity": -1.0},
        {"position": [-0.75, -0.75], "intensity": 1.0},
        {"position": [0.75, -0.75], "intensity": -1.0}
      ],
      "params": {"half_width": 1.0, "half_height": 1.0},
      "characteristic_size": 1.0,
      "recommended_depth_range": [0.15, 0.30]
    },
    
    "polygon": {
      "sources": [
        {"position": [0.3, 0.3], "intensity": 1.0},
        {"position": [1.5, 0.5], "intensity": -1.0},
        {"position": [0.5, 1.5], "intensity": 1.0},
        {"position": [0.7, 0.7], "intensity": -1.0}
      ],
      "params": {"vertices": [[0, 0], [2, 0], [2, 1], [1, 1], [1, 2], [0, 2]]},
      "characteristic_size": 1.0,
      "recommended_depth_range": [0.15, 0.30]
    },
    
    "brain": {
      "sources": [
        {"position": [0.4, 0.3], "intensity": 1.0},
        {"position": [-0.4, 0.3], "intensity": -1.0},
        {"position": [-0.3, -0.2], "intensity": 1.0},
        {"position": [0.3, -0.2], "intensity": -1.0}
      ],
      "characteristic_size": 0.8,
      "recommended_depth_range": [0.15, 0.30]
    }
  },
  
  "expected_performance": {
    "_description": "Expected RMSE thresholds for different configurations",
    "easy_validation": {"pass_threshold": 1e-04, "good_threshold": 1e-06},
    "easy_with_noise": {"pass_threshold": 0.02, "good_threshold": 0.005},
    "two_sources": {"pass_threshold": 1e-05, "good_threshold": 1e-08},
    "six_sources": {"pass_threshold": 0.02, "good_threshold": 0.005},
    "eight_sources": {"pass_threshold": 0.05, "good_threshold": 0.01},
    "deep_sources": {"pass_threshold": 0.10, "good_threshold": 0.02},
    "clustered_quadrant": {"pass_threshold": 0.05, "good_threshold": 0.01},
    "high_noise": {"pass_threshold": 0.10, "good_threshold": 0.03},
    "few_sensors": {"pass_threshold": 0.05, "good_threshold": 0.01},
    "stress_test": {"pass_threshold": 0.20, "good_threshold": 0.05}
  }
}
